function CarregarTurmasProfessor(){var n=parseInt($("#AnoLetivo").val());$.ajax({type:"POST",async:!0,dataType:"html",data:{anoLetivo:n},url:"/Avaliacao/TurmasProfessor",success:function(n){$("#divTurmasProfessor").empty().html(n);$("#tabelaDados").sedDataTable()},error:function(){}})}function ListaAtividadesContainer(n,t,i,r,u,f,e){u&&(e=$("#ddlAnoLetivo").val());$.ajax({type:"POST",async:!0,dataType:"html",data:{codigoDisciplina:n,codigoTurma:t,codigoSubTurma:i,codigoEscola:r,anoletivo:parseInt(e)},url:"/Avaliacao/ListaAtividadesContainer",success:function(n){if($("#SelecaoTurma").hide(),$("#divAnoLetivo").hide(),$("#Atividades").empty().html(n),$("#Atividades").show(),$("#btnVoltar").css("visibility","visible"),u!=undefined&&u){var t=f.parents("tr");$(".txtEscola").text(t.find(".selNomeEscola").text());$(".txtTipoEnsino").text(t.find(".selTipoEnsino").text());$(".txtTurma").text(t.find(".selNomeTurma").text());$(".txtSubTurma").text(t.find(".selNomeSubTurma").text());$(".txtDisciplina").text(t.find(".selNomeDisciplina").text())}else $(".txtEscola").text($("#CodigoEscola option:selected").text()),$(".txtTipoEnsino").text($("#CodigoTipoEnsino option:selected").text()),$(".txtTurma").text($("#CodigoTurma option:selected").text()),$(".txtSubTurma").text($("#CodigoSubTurma option:selected").text()),$(".txtDisciplina").text($("#CodigoDisciplina option:selected").text())},error:function(n,t,i){$(document).ajaxStop(function(){Mensagem.Alert({titulo:"Erro",mensagem:"Ocorreu um erro durante o processo: "+i,tipo:"Erro",botao:"Fechar"})})}})}function ListarAtividadesBoletim(n,t,i,r,u,f){r>0&&$.ajax({type:"POST",async:!0,dataType:"html",data:{codigoDisciplina:parseInt(n),codigoTurma:parseInt(t),codigoSubTurma:parseInt(i),codigoTipoEventoBimestre:parseInt(r),codigoEscola:parseInt(u),anoletivo:parseInt(f)},url:"/Avaliacao/ListaAtividades",success:function(e){var o,s;$("#ListaAtividades").empty().html(e);$("#ListaAtividades").find(".fg-toolbar").each(function(){$(this).hide()});$("#serieTabs").tabs();o=$("#hdnDesabilitar").val();o==1?($("select").prop("disabled","disabled"),$("#btnSalvar").hide(),$(".calendario").hide(),$("#ddlBimestre").prop("disabled","")):($("select").prop("disabled",""),$("#btnSalvar").show(),$(".calendario").show());s=parseInt($("#hdnCountAtividade").val());$(".tblNotasAtividade").each(function(){for(var n,r,t,i=0;i<s;i++)n=$(this).find("."+i).val(),r=$("#id"+n),$(this).find("label."+n).autoPreencher($(this).find(".ddl"+n),"Avaliacao","CarregarMencao",["txtDataAvaliacaoRealizadaInicio","txtDataAvaliacaoRealizadaFim"],null,r),$(this).find("label."+n).trigger("change"),t=r.find(".txtDataAvaliacaoRealizadaInicio").val(),t.length>0?$(this).find(".alunos").each(function(){var i=$(this).attr("dataFimMatricula"),r=i.substring(6,10)+"-"+i.substring(3,5)+"-"+i.substring(0,2),u=t.substring(6,10)+"-"+t.substring(3,5)+"-"+t.substring(0,2);r.length>0&&r<u&&($(this).find("td."+n).find(".ddlMencao").hide(),$(this).find("td."+n).append("<span>Matrícula Encerrada<\/span>"))}):$(this).find(".alunos").each(function(){$(this).find("td."+n).find(".ddlMencao").prop("disabled","disabled")})});$(".excluirAvaliacao").click(function(){var e=$(this).attr("codigoAtividade"),o=$(this).attr("nomeAtividade");Mensagem.Alert({titulo:"Atenção!",mensagem:'Deseja apagar todos os lançamentos de menção para a atividade <br />"'+o+'"?',tipo:"aviso",botoes:[{botao:"Sim",callback:function(){var o=$("input[name='frequencias.DataDaAula']").val();$.ajax({cache:!1,url:"/Avaliacao/ExcluirAvaliacao",type:"POST",datatype:"JSON",data:{codigoAtividade:e,codigoTurma:t,codigoSubturma:i},success:function(e){e.sucesso==!0&&ListarAtividadesBoletim(n,t,i,r,u,f)},error:function(){$.ajaxStop()}})}},{botao:"Não",callback:function(){$.unblockUI()}}]})})},error:function(n,t,i){alert(i);alert(t);$(document).ajaxStop(function(){Mensagem.Alert({titulo:"Erro",mensagem:"Ocorreu um erro durante o processo: "+i,tipo:"Erro",botao:"Fechar"})})}})}function CarregarLista(n,t,i,r,u){var f=$("#ddlBimestre").val();ListarAtividadesBoletim(n,t,i,f,r,u)}function CarregarAtividades(){var n=$("#CodigoDisciplina").val(),t=$("#CodigoTurma").val(),i=$("#CodigoSubTurma").val(),r=$("#CodigoEscola").val(),u=$("#AnoLetivo").val();n.length>0&&ListaAtividadesContainer(n,t,i,r,undefined,undefined,u)}function AbrirDataRealizada(n){$("#hdnCodigoAtividade").val(n);$(".divRealizacao").find("#txtDialogInicioRealizada").mask("99/99/9999");$(".divRealizacao").find("#txtDialogFimRealizada").mask("99/99/9999");var t=new Date,i=t.getMonth()+1,r=t.getFullYear();$("#txtDialogInicioRealizada").datepicker({maxDate:t,altField:"#txtDialogFimRealizada",onSelect:function(i){$(".divRealizacao").find("#txtDialogFimRealizada").datepicker("destroy");$("#txtDialogFimRealizada").datepicker({minDate:i,maxDate:t,onChangeMonthYear:function(t,i){VerificarDiasLetivosFim(n,t,i)},beforeShowDay:function(n){var i=n.getDate(),t;if(calendarEventsFim==null||calendarEventsFim==undefined)return[!1];for(t=0;t<calendarEventsFim.length;t++)if(calendarEventsFim[t].Dia==i)return[!0];return[!1]}});var r=i.split("/");VerificarDiasLetivosFim(n,r[2],r[1])},onChangeMonthYear:function(t,i){VerificarDiasLetivosInicio(n,t,i)},beforeShowDay:function(n){var i=n.getDate(),t;if(calendarEventsInicio==null||calendarEventsInicio==undefined)return[!1];for(t=0;t<calendarEventsInicio.length;t++)if(calendarEventsInicio[t].Dia==i)return[!0];return[!1]}});VerificarDiasLetivosInicio(n,r,i);$(".divRealizacao").dialog({width:600,draggable:!1,modal:!0,resizable:!1,show:{},position:"top",closeOnEscape:!1,open:function(){$(".ui-dialog-titlebar-close").hide()}})}function CancelarRealizacao(){$(".divRealizacao").find("#txtDialogInicioRealizada").val("");$(".divRealizacao").find("#txtDialogFimRealizada").val("");$(".divRealizacao").find("#txtDialogInicioRealizada").datepicker("destroy");$(".divRealizacao").find("#txtDialogFimRealizada").datepicker("destroy");$(".divRealizacao").dialog("close")}function ConfirmaRealizacao(){var n=$("#hdnCodigoAtividade").val(),t=$(".divRealizacao").find("#txtDialogInicioRealizada").val(),i=$(".divRealizacao").find("#txtDialogFimRealizada").val();regex=/^(((0[1-9]|[12]\d|3[01])\/(0[13578]|1[02])\/((19|[2-9]\d)\d{2}))|((0[1-9]|[12]\d|30)\/(0[13456789]|1[012])\/((19|[2-9]\d)\d{2}))|((0[1-9]|1\d|2[0-8])\/02\/((19|[2-9]\d)\d{2}))|(29\/02\/((1[6-9]|[2-9]\d)(0[48]|[2468][048]|[13579][26])|((16|[2468][048]|[3579][26])00))))$/;t!=""&&i!=""&&t.match(regex)&&i.match(regex)?($("#id"+n).find(".txtDataAvaliacaoRealizadaInicio").val(t),$("#id"+n).find(".txtDataAvaliacaoRealizadaFim").val(i),$("label."+n).change(function(){$(".alunos").each(function(){var u=$(this).attr("dataFimMatricula"),f=u.substring(6,10)+"-"+u.substring(3,5)+"-"+u.substring(0,2),e=t.substring(6,10)+"-"+t.substring(3,5)+"-"+t.substring(0,2),h=i.substring(6,10)+"-"+i.substring(3,5)+"-"+i.substring(0,2),r,o,s;$(this).find("td."+n).find("span").remove();f.length>0&&f<e?($(this).find("td."+n).find(".ddlMencao").hide(),$(this).find("td."+n).append("<span>Matrícula Encerrada<\/span>")):(r=$(this).find("td."+n).find(".ddlMencao"),r.not(".comDispensa").show().prop("disabled",""),r.hasClass("comDispensa")&&(o=r.data("dispensa_inicio").substring(6,10)+"-"+r.data("dispensa_inicio").substring(3,5)+"-"+r.data("dispensa_inicio").substring(0,2),s=r.data("dispensa_fim").substring(6,10)+"-"+r.data("dispensa_fim").substring(3,5)+"-"+r.data("dispensa_fim").substring(0,2),o<=e&&s>=h?($(this).find("td."+n).find(".ddlMencao").hide(),$(this).find("td."+n).append("<span>Dispensa: "+r.data("dispensa_tipo")+"<\/span>")):($(this).find("td."+n).find(".ddlMencao").show(),$(this).find("td."+n).find("span").remove(),r.show().prop("disabled",""))))})}),$("label."+n).html("De "+t+" até "+i),$("label."+n).trigger("change"),$(".divRealizacao").dialog("close")):CancelarRealizacao()}function SetarFlag(n){var t=$(n).attr("flag");t.length==0&&(t=0);t=parseInt(t);t=t+1;$(n).attr("flag",t)}function Salvar(){var n=[];$(".tblNotasAtividade tbody tr td").each(function(){var i=$(this).find(".ddlMencao").attr("codAtividade"),t,r;i!=undefined&&(t=$("#id"+i).find(".txtDataAvaliacaoRealizadaInicio").val(),r=$("#id"+i).find(".txtDataAvaliacaoRealizadaFim").val(),t.length>0&&t!=undefined&&$(this).find(".ddlMencao").val()>0&&n.push({cdAvaliacaoAluno:$(this).find(".ddlMencao").attr("codAvaliacao"),cdMatriculaAluno:$(this).find(".ddlMencao").attr("codMatricula"),cdAtividade:$(this).find(".ddlMencao").attr("codAtividade"),cdMencao:$(this).find(".ddlMencao").val(),cdEvento:$(this).find(".ddlMencao").attr("codEvento"),flag:$(this).find(".ddlMencao").attr("flag"),dataInicio:t,dataFim:r}))});$.ajax({type:"POST",async:!0,dataType:"html",data:{listaAvaliacaoAlunoJson:JSON.stringify(n)},url:"/Avaliacao/SalvarLancamento",success:function(){$("#ddlBimestre").trigger("change")},error:function(n,t,i){$(document).ajaxStop(function(){Mensagem.Alert({titulo:"Erro",mensagem:"Ocorreu um erro durante o processo: "+i,tipo:"Erro",botao:"Fechar"})})}})}function VoltarTurmas(){$("select").prop("disabled","");$("#SelecaoTurma").show();$("#divAnoLetivo").show();$("#Atividades").hide();$("#btnVoltar").css("visibility","hidden")}function DataTable(){}function ZeraTurma(){$("#CodigoTurma option").each(function(){$(this).val()!=""&&$(this).remove()});$("#CodigoTipoEnsino option[value='']").attr("selected","selected");$("#CodigoDisciplina option[value='']").attr("selected","selected")}var calendarEventsInicio,calendarEventsFim,anoLetivoAnterior,linkButton,VerificarMudancaAnoLetivo=function(n,t,i,r,u,f){n.get(0).tagName=="INPUT"?(n.focus(function(){anoLetivoAnterior=n.val();$(document).keypress(function(n){if(n.which==13)return!1})}),n.blur(function(){var n=$(this).val();n!=anoLetivoAnterior&&e($(this),anoLetivoAnterior)})):n.get(0).tagName=="SELECT"&&(n.click(function(){anoLetivoAnterior=n.val()}),n.change(function(){e($(this),anoLetivoAnterior)}));var e=function(n,e){Mensagem.Alert({titulo:"Atenção!",mensagem:"Ao alterar o valor do ano letivo, todos os dados informados no formulário serão perdidos. Deseja continuar?",tipo:"aviso",botoes:[{botao:"Sim",callback:function(){var e="<option value=''>Selecione...<\/option>";t.attr("selected","selected");i.empty();i.html(e);r.empty();r.html(e);u.empty();u.html(e);f.empty();f.html(e);AnoLetivoAnterior=$(n).val();$.unblockUI()}},{botao:"Não",callback:function(){$(n).val(e);$.unblockUI();$(n).focus()}}]})}},VerificarDiasLetivosInicio,VerificarDiasLetivosFim;$(document).ready(function(){calendarEventsInicio=null;calendarEventsFim=null;$("#CodigoDiretoria").autoPreencher($("#CodigoEscola"),"Escola","CarregarListaEscolas");$("#CodigoEscola").autoPreencher($("#CodigoTipoEnsino"),"TipoEnsino","CarregarListaTiposEnsino",[{id:"CodigoEscola",AnoLetivo:"AnoLetivo"}]);$("#CodigoTipoEnsino").autoPreencher($("#CodigoTurma"),"Turma","CarregarListaTurmaPorTipoEnsino",["CodigoEscola","CodigoTipoEnsino","AnoLetivo"],undefined);$("#CodigoTurma").autoPreencher($("#CodigoDisciplina"),"Disciplina","ListaDisciplinasComParametrizacaoeQuebraAvaliacao",["CodigoTurma","AnoLetivo"],undefined);$("#CodigoTurma").change(function(){var n=$("#CodigoSubTurma"),t;n.empty();n.append(new Option("Selecione...","0",!0,!0));t=$(this).val();t>0&&$.getJSON("/AtribuicaoAula/SubTurmas",{turma:t},function(t){$.each(t,function(t,i){n.append($("<option/>",{value:i.Value,text:i.Text}))})})});$("#formPesquisar").validate({rules:{AnoLetivo:{required:!0},CodigoDiretoria:{required:!0},CodigoEscola:{required:!0},CodigoTipoEnsino:{required:!0},CodigoTurma:{required:!0},CodigoDisciplina:{required:!0}},messages:{AnoLetivo:{required:"Obrigatório"},CodigoDiretoria:{required:"Obrigatório"},CodigoEscola:{required:"Obrigatório"},CodigoTipoEnsino:{required:"Obrigatório"},CodigoTurma:{required:"Obrigatório"},CodigoDisciplina:{required:"Obrigatório"}}});$("#btnPesquisar").click(function(n){n.preventDefault();$("#formPesquisar").valid()&&CarregarAtividades()})});VerificarDiasLetivosInicio=function(n,t,i){calendarEventsInicio=null;$.ajax({url:"/Avaliacao/RecuperarDiasLetivos",type:"POST",dataType:"JSON",data:{codigoAtividade:n,anoLetivo:t,mes:i},success:function(n){calendarEventsInicio=n;$("#txtDialogInicioRealizada").datepicker("refresh")},error:function(){$(document).ajaxStop()}})};VerificarDiasLetivosFim=function(n,t,i){calendarEventsFim=null;$.ajax({url:"/Avaliacao/RecuperarDiasLetivos",type:"POST",dataType:"JSON",data:{codigoAtividade:n,anoLetivo:t,mes:i},success:function(n){calendarEventsFim=n;$("#txtDialogFimRealizada").datepicker("refresh")},error:function(){$(document).ajaxStop()}})};
/*
//# sourceMappingURL=Avaliacao.min.js.map
*/