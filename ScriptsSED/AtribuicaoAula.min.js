function visualizarDis(n,t,i){if(n==""||t==""||i==""){alert("É obrigatória a seleção da diretoria, escola e preenchimento do CPF.");return}$.ajax({url:"/AtribuicaoAula/PesquisarDi",type:"POST",dataType:"html",data:{cdDiretoria:n,cdEscola:t,cpf:i},success:function(r){$("#resultadoPesquisaCpf").show().html(r);$("#resultadoPesquisaTile").hide();AplicarMascaras();fct_ListarAtribuicoes(n,t,i)}})}function visualizarAtribuicoes(n){element=n;var t=n.parent(),i=t.find(".selNumeroCpf").val(),r=t.find(".selCdDiretoria").val(),u=t.find(".selCdEscola").val(),f=t.find(".selDi").val(),e=t.find(".selAnoLetivo").val();$.ajax({url:"/AtribuicaoAula/VisualizarAtribuicoes",type:"POST",dataType:"html",data:{cdDiretoria:r,cdEscola:u,cpf:i,di:f,AnoLetivo:e},success:function(n){$("#modalVisualizar").html(n).dialog({modal:!0,width:810,position:["center",0],close:function(){element=null;$("#modalVisualizar").html("");$("#modalVisualizar").dialog("destroy")}});AplicarMascaras();triggerEditarAtribuicao();triggerExcluirAtribuicao();triggerEditarAtribuicaoAtpc();triggerExcluirAtribuicaoAtpc();triggerEditarAulaAtpc();flag?(HabilitarEdicao(),flag=!1):$(".selInserirAtribuicao, .selEdicao, .selExclusao").hide()}})}function visualizarHistoricoAtribuicoes(n){var t=n.parent(),i=t.find(".selNome").val(),r=t.find(".selNumeroCpf").val(),u=t.find(".selCdDiretoria").val(),f=t.find(".selCdEscola").val(),e=t.find(".selOutrasEscolas").val();$.ajax({url:"../../Relatorios/AtribuicaoRel/RelatorioHistoricoAtribuicoes",type:"POST",dataType:"json",data:{cdDiretoria:u,cdEscola:f,cpf:r,nome:i,outrasEscolas:e},success:function(){window.open("../../Relatorios/AtribuicaoRel/GerarPdf","_self")}})}function GerarPdf(n){window.open("/AtribuicaoAula/GerarPdf?cpfProfessor="+n,"_self")}function GerarXls(n){window.open("/AtribuicaoAula/GerarXls?cpfProfessor="+n,"_self")}function visualizarHistoricoAtribuicoesXls(n){var t=n.parent(),i=t.find(".selNome").val(),r=t.find(".selNumeroCpf").val(),u=t.find(".selCdDiretoria").val(),f=t.find(".selCdEscola").val(),e=t.find(".selOutrasEscolas").val();$.ajax({url:"../../Relatorios/AtribuicaoRel/RelatorioHistoricoAtribuicoes",type:"POST",dataType:"json",data:{cdDiretoria:u,cdEscola:f,cpf:r,nome:i,outrasEscolas:e},success:function(){window.open("../../Relatorios/AtribuicaoRel/GerarExcel","_self")}})}function fct_ListarAtribuicoes(n,t,i){$.ajax({url:"/AtribuicaoAula/PesquisarAtribuicoes",type:"POST",dataType:"html",data:{cdDiretoria:n,cdEscola:t,cpf:i},success:function(r){$("#ListaAtribuicoes").html(r);$("#tbAtribuicoes").find(".selEdicao").hide();$("#tbAtribuicoes").find(".selExclusao").hide();fct_ListarAtribuicoesAtpc(n,t,i)}})}function fct_ListarAtribuicoesAtpc(n,t,i){$.ajax({url:"/AtribuicaoAula/PesquisarAtribuicoesAtpc",type:"POST",dataType:"html",data:{cdDiretoria:n,cdEscola:t,cpf:i},success:function(n){$("#ListaAtribuicoesAtpc").html(n);$("#tbAtribuicoesAtpc").find(".selEdicao").hide();$("#tbAtribuicoesAtpc").find(".selExclusao").hide()}})}function renderPesquisa(n){$("#resultadosPesquisa").html(n);$("#tblAtribuicoes").sedDataTable();$("#resultadosPesquisa").find(".cpf").mask("000.000.000-00")}function FuncoesTile(){$("#btnPesquisarProfessoresTile").click(function(){var n=$("#ddlDiretoriaCadastro option:selected").val(),t=$("#ddlEscolaCadastro option:selected").val();if(n==""||t==""){alert("É necessário primeiro selecionar uma Diretoria e uma Escola.");return}$("#professoresTile").dialog({modal:!0,width:810,position:["center",0],show:{duration:500,position:{top:500}},hide:{duration:500},close:function(){$("#professoresTile").dialog("destroy")}})});$(".tile").unbind("click").click(function(){var n=$(this).text(),t=$("#ddlEscolaCadastro option:selected").val(),i=$("#ddlDiretoriaCadastro option:selected").val();$.ajax({url:"/AtribuicaoAula/ResultadoPesquisa",type:"POST",dataType:"html",data:{letraInicial:n,codigoEscola:t,codigoDiretoria:i},success:function(n){$("#resultadoPesquisaCpf").hide();$("#resultadoPesquisaTile").show().html(n);$("#professoresTile").dialog("close")}})})}function validacoes(){$("#formAdicionarAtribuicao").validate({rules:{CdTipoEnsino:"required",CdTurma:"required",CdDisciplina:"required",DtInicioVigencia:"required",DtFimVigencia:"required"},messages:{CdTipoEnsino:"Obrigatório",CdTurma:"Obrigatório",CdDisciplina:"Obrigatório",DtInicioVigencia:"Obrigatório",DtFimVigencia:"Obrigatório"}});$("#formAdicionarEditarAula").validate({rules:{ddlDiaDaSemanaAula:"required",HoraDeInicioDasAulas:{required:!0},HoraDeFimDasAulas:{required:!0},DtInicioVigencia:"required",DtFimVigencia:"required"},messages:{DiaDaSemana:"Obrigatório",HoraDeInicioDasAulas:"Obrigatório",HoraDeFimDasAulas:"Obrigatório",DtInicioVigencia:"Obrigatório",DtFimVigencia:"Obrigatório"}})}function alterarAtribuicao(){if($("#FormListarEditarAtribuicaoAulA").valid()){var n={CdAtribuicao:$(".selCdAtribuicao").val(),DtInicioVigencia:$("#DtInicioVigenciaEditar").val(),DtFimVigencia:$("#DtFimVigenciaEditar").val(),Cpf:$("#txtCpf").val(),Di:$(".selDi").val(),CdDisciplina:$("#ddlDisciplinaCadastro").val(),CdTurma:$("#ddlTurmaCadastro").val(),"SubTurma.Codigo":$("#ddlSubTurmaCadastro").val(),Tp_Atrib:$("#ddlTpAtrib").val()};$.post("/AtribuicaoAula/EditarAtribuicao",n)}}function fct_CarregarSubTurmas(n){var t=$("#ddlSubTurmaCadastro");t.empty();t.append(new Option("Selecione...","",!0,!0));n>0&&$.getJSON("/AtribuicaoAula/SubTurmas",{turma:n},function(n){fct_ValidarSubTurma(n.length);$.each(n,function(n,i){t.append($("<option/>",{value:i.Value,text:i.Text}))})})}function fct_ValidarSubTurma(n){n>0?$("#sub_turma").show():$("#sub_turma").hide()}function abrirFormAtribuicao(n,t,i,r,u,f){$.ajax({url:"/AtribuicaoAula/ViewAdicionarAtribuicao",type:"POST",data:{cdDiretoria:n,cdEscola:t,cpf:i,di:r,nome:u,flSituacao:f},success:function(e){$("#formAtribuicao").html(e).dialog({modal:!0,draggable:!1,width:685,position:["center",0],close:function(){element==null?PesquisarDi(n,t,i,r,u,f):(visualizarAtribuicoes(element),flag=!0);$("#formAtribuicao").dialog("destroy")}});AplicarMascaras();$("#ddlTipoEnsinoCadastro").autoPreencher($("#ddlTurmaCadastro"),"Turma","CarregarListaTurmaPorTpAtribuicao",[{CodigoEscola:"CdEscola",CodigoTipoEnsino:"CdTipoEnsino",TpAtribuicao:"Tp_atrib"}],null,$("#formAtribuicao"));$("#ddlTurmaCadastro").autoPreencher($("#ddlDisciplinaCadastro"),"Disciplina","CarregarListaDisciplinas");$("#ddlTpAtrib").change(function(){switch($(this).val()){case"3":case"4":$(".selCamposAtribuicao").hide();$("#divCamposAtribuicaoPaa").hide();$("#divCadastrarAtribuicaoPAA").hide();$(".selCamposAtribuicao select").each(function(){$(this).find("option:first").prop("selected",!0)});$("#divCamposAtribuicaoPaa select").each(function(){$(this).find("option:first").prop("selected",!0)});$("#fieldsetListaDeAula").show();break;case"6":$(".selCamposAtribuicao").hide();$("#fieldsetListaDeAula").hide();$(".selCamposAtribuicao select").each(function(){$(this).find("option:first").prop("selected",!0)});$("#divCamposAtribuicaoPaa select").each(function(){$(this).find("option:first").prop("selected",!0)});$("#divCamposAtribuicaoPaa").show();$("#divCadastrarAtribuicaoPAA").show();$("#ddlTipoEnsinoCadastro").show();var n=(new Date).getFullYear();$("#DtInicioVigenciaInserir").datepicker("option","yearRange",n+":"+n);$("#DtFimVigenciaInserir").datepicker("option","yearRange",n+":"+n);fct_CarregarTurnoPaa(t);break;default:$(".selCamposAtribuicao").show();$("#fieldsetListaDeAula").show();$("#divCamposAtribuicaoPaa").hide();$("#divCadastrarAtribuicaoPAA").hide()}$("#ddlTipoEnsinoCadastro").val("");$("#ddlTipoEnsinoCadastro").trigger("change")});$("#DtInicioVigenciaInserir").datepicker("option","numberOfMonths",1).datepicker("setDate",null);$("#DtFimVigenciaInserir").datepicker("option","numberOfMonths",1).datepicker("setDate",null);$("#ddlTurmaCadastro").change(function(){fct_CarregarSubTurmas($(this).val())});$("#ddlDisciplinaCadastro").change(function(){$("#ddlDisciplinaCadastro").val()!=""?$.ajax({url:"/AtribuicaoAula/SelecionarDatasInicialFinalVigencia",type:"GET",dataType:"json",data:{cdTurma:$("#ddlTurmaCadastro option:selected").val(),cdDisciplina:$("#ddlDisciplinaCadastro option:selected").val()},success:function(n){var t,i;if(n[0]==null)var u=new Date,r=u.getFullYear(),t=new Date(r,01,27),i=new Date(r,12,19);else t=new Date(parseInt(n[0].dtInicioVigencia.substr(6))),i=new Date(parseInt(n[0].dtFimVigencia.substr(6))),$("#DtInicioVigenciaInserir").datepicker("setDate",t).datepicker("option","minDate",t).datepicker("option","maxDate",i),$("#DtFimVigenciaInserir").datepicker("setDate",i).datepicker("option","minDate",t).datepicker("option","maxDate",i)}}):($("#DtInicioVigenciaInserir").datepicker("setDate",null),$("#DtFimVigenciaInserir").datepicker("setDate",null))})}})}function PesquisarDi(n,t,i){$.ajax({url:"/AtribuicaoAula/PesquisarAtribuicoes",type:"POST",dataType:"html",data:{cdDiretoria:n,cdEscola:t,cpf:i},success:function(){$("#ddlDiretoriaCadastro").val(n);$("#ddlEscolaCadastro").val(t);$("#txtCpfCadastro").val(i);visualizarDis(n,t,i)}})}function abrirAgendaProfessor(n){_cpf=n;var t=$("#ddlEscolaCadastro").val();$.ajax({url:"/AtribuicaoAula/AgendaProfessor",dataType:"html",type:"POST",data:{cpf:n,escola:t},success:function(n){$("#ResultHoras").html(n).dialog({width:950,modal:!0,resizable:!1,position:["center",0],close:function(){$("#ResultHoras").html("");$("#ResultHoras").dialog("destroy")}});var t=$.cookie("tabGradeAula_font-size");t!=undefined&&t>9?$("#TabelaGradeAulaProfessor").sedDataTable({sScrollX:"100%",sZeroRecords:"Não foram encontrados resultados",bPaginate:!1}):$("#TabelaGradeAulaProfessor").sedDataTable({sScrollX:"100%",sZeroRecords:"Não foram encontrados resultados",bPaginate:!1})}})}function adicionarAtribuicao(n){if(n.Sucesso){var t=$("#Cpf").val(),i=$("#ddlDiretoriaCadastro").val(),r=$("#ddlEscolaCadastro").val(),u=$("#txtDi").val(),f=$(".selAnoLetivo").val();triggerEditarAtribuicao();triggerExcluirAtribuicao()}}function editarAula(n){var u,r,f,t,i;if(n.Sucesso){for(u=$("#formEditarAula"),r=$("tr[cdAula="+n.DadosAula[0].CodigoAula+"]"),r.find(".selDataInicio").text(n.DadosAula[0].DataInicioVigencia),r.find(".selDataFim").text(n.DadosAula[0].DataFimVigencia),r.find(".selDiaDaSemana").text(u.find(".ddlDiaDaSemana option:selected").text()),r.find(".selHoraDeInicioDasAulas").text(n.DadosAula[0].HoraInicio),r.find(".selHoraDeFimDasAulas").text(n.DadosAula[0].HoraFim),f=$("table.tbAulas"),f.find(".semResultado").hide(),t=1;t<n.length;t++)for(i=0;i<n[t].DadosAula.length;i++)f.append('<tr cdAula="'+n[t].DadosAula[i].CodigoAula+'" cdAtrib="'+n[t].DadosAula[i].CodigoAtribuicao+'" ><td style="text-align: center !important; font-size: 14px;" class="selDataFim">'+n[t].DadosAula[i].DataInicioVigencia+'<\/td><td style="text-align: center !important; font-size: 14px;" class="selDataFim">'+n[t].DadosAula[i].DataFimVigencia+'<\/td><td style="text-align: center !important; font-size: 14px;" class="selDiaDaSemana">'+n[t].DadosAula[i].NomeSemana+'<\/td><td style="text-align: center !important; font-size: 14px;" class="selHoraDeInicioDasAulas">'+n[t].DadosAula[i].HoraInicio+'<\/td><td style="text-align: center !important; font-size: 14px;" class="selHoraDeFimDasAulas">'+n[t].DadosAula[i].HoraFim+'<\/td><td style="text-align: center"><a class="selEditarAula"><i class="icone-tabela-editar" title="Editar"><\/i><\/a><\/td><td style="text-align: center"><a class="selExcluirAula"><i class="icone-tabela-excluir" title="Excluir"><\/i><\/a><\/td><\/tr>');u.html("");u.dialog("destroy")}}function ObterFormAtribuicao(){return $("#formAtribuicao").find(".selCdAtribuicao").length>0?$("#formAtribuicao"):$("#formEditarAtribuicao")}function abrirFormAula(n){var t=$("#"+n);$(t).validate().checkForm()==!1&&event.defaultPrevented();var i=t.find("#ddlTpAtrib").val(),e=t.find("#ddlTipoEnsinoCadastro").val(),o=t.find("#ddlTurmaCadastro").val(),c=t.find("#ddlSubTurmaCadastro").val(),s=t.find("#ddlDisciplinaCadastro").val(),l=t.find(".selCdAtribuicao").val(),a=t.find(".selCdDiretoria").val(),r=t.find(".selCdEscola").val(),v=t.find(".selCpf").val(),y=t.find(".selDi").val(),u=n=="formAtribuicao"?t.find("#DtInicioVigenciaInserir").val():t.find("#DtInicioVigenciaEditar").val(),f=n=="formAtribuicao"?t.find("#DtFimVigenciaInserir").val():t.find("#DtFimVigenciaEditar").val(),h=n=="formAtribuicao"?t.find("#ddlTurnosPaa").val():t.find("#CdTurnoPaa").val();if(r==0&&i==6&&(r=$("#formIndex").find("#ddlEscolaPesquisar").val()),i==""||(i=="1"||i=="2")&&(e==""||o==""||s=="")||(i=="3"||i=="4")&&(u==""||f=="")||i=="6"&&(h==""||u==""||f=="")){alert("É necessário preencher todos os dados da atribuição");return}$.ajax({url:"/AtribuicaoAula/ViewAdicionarAula",type:"POST",dataType:"html",data:{CdAtribuicao:l,CdDiretoria:a,CdEscola:r,Cpf:v,Di:y,DtInicioVigencia:u,DtFimVigencia:f,Tp_atrib:i,CdTipoEnsino:e,CdTurma:o,CdDisciplina:s,"SubTurma.Codigo":c,CdTurnoPaa:h},success:function(n){var t,r,u,f;i!=6?($("#formAula").html(n).dialog({modal:!0,draggable:!1,width:600,position:["center",0],close:function(){$("#formAula").html("");$("#formAula").dialog("destroy")}}),ValidacoesHoraAula(),AplicarMascaras(),InserirAlterarAula()):CarregarModalAtribuicaoPaa(n);$("#formAtribuicao").find(".selInsercao").val()=="True"?($("#DtInicioVigenciaInserir2").datepicker("option","numberOfMonths",1).datepicker("setDate",null),$("#DtFimVigenciaInserir2").datepicker("option","numberOfMonths",1).datepicker("setDate",null),$("#DtInicioVigenciaInserir").val()!=""&&(t=$("#DtInicioVigenciaInserir").val(),r=$("#DtFimVigenciaInserir").val(),$("#DtInicioVigenciaInserir2").datepicker("setDate",t).datepicker("option","minDate",t).datepicker("option","maxDate",r),$("#DtFimVigenciaInserir2").datepicker("setDate",r).datepicker("option","minDate",t).datepicker("option","maxDate",r))):$("#DtInicioVigenciaEditar").val()!=""&&(u=$("#DtInicioVigenciaEditar").val(),f=$("#DtFimVigenciaEditar").val(),$("#DtInicioVigenciaInserir2").datepicker("setDate",u).datepicker("option","minDate",u).datepicker("option","maxDate",f),$("#DtFimVigenciaInserir2").datepicker("setDate",f).datepicker("option","minDate",u).datepicker("option","maxDate",f))}})}function ValidacoesHoraAula(){$("#txtHoraDeInicioDasAulasAula").focusout(function(){CalcularHoraAula()});$("#txtHoraDeFimDasAulasAula").focusout(function(){CalcularHoraAula()});$("#ddlTempoDeAula").change(function(){CalcularHoraAula()})}function CalcularHoraAula(){if($("#txtHoraDeInicioDasAulasAula").val()==""){$("#txtHoraDeFimDasAulasAula").val("");return}if($("#ddlTempoDeAula").val()!=""){var i=$("#txtHoraDeInicioDasAulasAula").val().split(":"),n=parseInt(i[0]),t=parseInt(i[1])+parseInt($("#ddlTempoDeAula").val());if(t>59&&(t=t-60,n=n+1),n==23){if(t>19){$("#txtHoraDeFimDasAulasAula").val("23:59");return}}else if(n>23){$("#txtHoraDeFimDasAulasAula").val("23:59");return}}}function triggerEditarAtribuicao(){$(".selEditarAtribuicao").unbind("click").click(function(n){n.stopPropagation();var t=$(this).parents("tr");$.ajax({url:"/AtribuicaoAula/ViewEditarAtribuicao",type:"POST",dataType:"html",data:{cdAtribuicao:t.attr("cdAtribuicao"),di:$("#hdnNr_di").val()},success:function(n){$("#formEditarAtribuicao").html(n).dialog({modal:!0,draggable:!1,width:685,position:["center",0],close:function(){element==null?PesquisarDi(cdDiretoria,cdEscola,cpf,di,nome,flSituacao):(visualizarAtribuicoes(element),flag=!0);$("#formEditarAtribuicao").html("");$("#formEditarAtribuicao").dialog("destroy")}});AplicarMascaras();triggerEditarAula();triggerExcluirAula()}})})}function triggerExcluirAtribuicao(){$(".selExcluirAtribuicao").unbind("click").click(function(n){if(n.stopPropagation(),confirm("Tem certeza que deseja excluir essa atribuição?")){var t=$(this).parents("tr");$.ajax({url:"/AtribuicaoAula/ExcluirAtribuicao",type:"POST",data:{cdAtribuicao:t.attr("cdAtribuicao")},success:function(n){if(n.Sucesso&&(t.remove(),$("#nrAulas").length>0)){var i=parseInt($.trim($("#nrAulas").text()));$("#nrAulas").text(i-n.NumeroAulas)}}})}})}function triggerEditarAula(){$(".selEditarAula").unbind("click").click(function(n){n.stopPropagation();var t=$(this).parents("tr").eq(0),i=t.attr("cdAula"),r=$(".selCdAtribuicao").val();$.ajax({url:"/AtribuicaoAula/ViewEditarAula",type:"POST",dataType:"html",data:{cdAula:i,cdAtrib:r},success:function(n){$("#formEditarAula").html(n).dialog({modal:!0,draggable:!1,width:600,position:["center",0],close:function(){$("#formEditarAula").html("");$("#formEditarAula").dialog("destroy")}});validacoes();AplicarMascaras();$("#ddlDiaDaSemanaAula").val($("#diaSemana").val());$("#ddlTempoDeAula").val($("#tempoAula").val());InserirAlterarAula()}})})}function triggerExcluirAula(){$(".selExcluirAula").unbind("click").click(function(n){n.stopPropagation();var t=$(this).parents("tr").eq(0),r=t.attr("cdAula"),i=$(".selCdAtribuicao").val();confirm("Tem certeza que deseja excluir essa Aula?")&&$.ajax({url:"/AtribuicaoAula/ExcluirAula",type:"POST",data:{cdAula:r,cdAtrib:i},success:function(n){if(n.Sucesso){if(t.remove(),$("#nrAulas").length>0){var r=parseInt($.trim($("#nrAulas").text()));$("#nrAulas").text(r-1)}n.UltimaAula!=undefined&&n.UltimaAula&&($("#tbAtribuicoes").find("tr[cdAtribuicao="+i+"]").remove(),$(".selCdAtribuicao").val(0))}}})})}function HabilitarEdicao(){triggerEditarAtribuicao();triggerExcluirAtribuicao();triggerEditarAulaAtpc();triggerExcluirAulaAtpc();$(".selInserirAtribuicao, .selEdicao, .selExclusao").show();$("#spanTitulo").html("Edição de Atribuição de Aula");$("#btnHabilitarEdicao").hide()}function validarHoraAtpc(){if($("#txtHoraDeInicioDasAulasAulaAtpc").val().length!=5||$("#txtHoraDeFimDasAulasAulaAtpc").val().length!=5)return alert("Hora inválida"),!1;var n=$("#txtHoraDeInicioDasAulasAulaAtpc").val().split(":")[0],t=$("#txtHoraDeInicioDasAulasAulaAtpc").val().split(":")[1],i=$("#txtHoraDeFimDasAulasAulaAtpc").val().split(":")[0],r=$("#txtHoraDeFimDasAulasAulaAtpc").val().split(":")[1],u=n>="00"&&n<="23"&&t>="00"&&t<="59"&&i>="00"&&i<="23"&&r>="00"&&r<="59";return u?u:(alert("Hora inválida"),!1)}function ValidarCamposAdicionarAula(){var u=$(".cbDiasSemana:checked").size(),f=$(".ddlDiaDaSemana").size(),n=parseInt($("#txtHoraDeInicioDasAulasAula").val().split(":")[0]),t=parseInt($("#txtHoraDeInicioDasAulasAula").val().split(":")[1]),i=parseInt($("#txtHoraDeFimDasAulasAula").val().split(":")[0]),r=parseInt($("#txtHoraDeFimDasAulasAula").val().split(":")[1]),o=parseInt($(".ddlQuantidadeMinutos").val()),e=n>=00&&n<=23&&t>=00&&t<=59&&i>=00&&i<=23&&r>=00&&r<=59;return u==0&&f==0?(alert("Campo Dias da Semana é obrigatório."),!1):$(".ddlQuantidadeMinutos").val()==""?(alert("Campo Tempo de Aula é obrigatório."),!1):e?$("#txtHoraDeInicioDasAulasAula").val()==$("#txtHoraDeFimDasAulasAula").val()?(alert("A hora início não pode ser igual a hora final"),!1):$("#DtInicioVigenciaInserir2").val()==""?(alert("Campo Início de Vigência é obrigatório."),!1):$("#DtFimVigenciaInserir2").val()==""?(alert("Campo Início de Vigência é obrigatório."),!1):!0:(alert("Hora inválida"),!1)}function ValidarInserirAula(){$("#formAdicionarEditarAula").validate({rules:{"ListaAula[0].DiaDaSemana":"required","ListaAula[0].DtInicioVigencia":"required","ListaAula[0].DtFimVigencia":"required","ListaAula[0].HoraDeInicioDasAulas":"required","ListaAula[0].HoraDeFimDasAulas":"required"},messages:{"ListaAula[0].DiaDaSemana":"Obrigatório","ListaAula[0].DtInicioVigencia":"Obrigatório","ListaAula[0].DtFimVigencia":"Obrigatório","ListaAula[0].HoraDeInicioDasAulas":"Obrigatório","ListaAula[0].HoraDeFimDasAulas":"Obrigatório"}})}function CarregarModalAtribuicaoPaa(n){$("#formAulaPaa").html(n).dialog({modal:!0,draggable:!1,width:600,position:["center",0]});ValidacoesHoraAula();AplicarMascaras();ValidarAulaPaa();InserirAulasPaa()}function ValidarAulaPaa(){$("#btnAdicionarAulaPaa").click(function(n){if(n.preventDefault(),ValidarCamposAdicionarAula())$.ajax({cache:!1,url:"/AtribuicaoAula/ValidarAulaPaa",type:"POST",dataType:"JSON",data:$("#formAdicionarEditarAula").serialize(),success:function(n){n.Sucesso&&fct_AdicionarAulaPaaNaTabela(n)},error:function(){$.ajaxStop()}});else return!1});ValidarInserirAula()}function InserirAulasPaa(){$("#btnSalvarAulasPaa").click(function(){$.ajax({cache:!1,url:"/AtribuicaoAula/InserirEditarAulaPaa",type:"POST",dataType:"JSON",data:$("#formAdicionarEditarAula").serialize(),success:function(){$("#formAulaPaa").dialog("close");$("#formAtribuicao").dialog("close")},error:function(){$.ajaxStop()}})})}function EditarAulasPaa(){}function fct_AdicionarAulaPaaNaTabela(n){var i,r,t;if(n.Sucesso){for(i=$("#ddlDiaDaSemanaAula option:selected").val(),r=$("#ListaAula_0__QuantidadeMinutos option:selected").val(),$("#tblHorasPAA").find("tr")[1].cells.length==1&&$("#tblHorasPAA tbody tr").remove(),t=0;t<n.DadosAula.length;t++)$("#tblHorasPAA tbody").append('<tr><td style="text-align: center !important;">0<\/td><td style="text-align: center !important;" class="selDataInicio">'+n.DadosAula[t].DataInicioVigencia+'<input id="Codigo" type="hidden" name="AulaPaa[0].Codigo" value="'+n.DadosAula[t].CodigoAula+'" /><input id="InicioVigencia" type="hidden" name="AulaPaa[0].DtInicioVigencia" value="'+n.DadosAula[t].DataInicioVigencia+'" /><\/td><td style="text-align: center !important;" class="selDataFim">'+n.DadosAula[t].DataFimVigencia+'<input id="FimVigencia" type="hidden" name="AulaPaa[0].DtFimVigencia" value="'+n.DadosAula[t].DataFimVigencia+'" /><\/td><td style="text-align: center !important;" class="selDiaDaSemana">'+n.DadosAula[t].NomeSemana+'<input id="DiaDaSemana" type="hidden" name="AulaPaa[0].DiaDaSemana" value="'+i+'" /><\/td><td style="text-align: center !important;" class="selHoraDeInicioDasAulas">'+n.DadosAula[t].HoraInicio+'<input id="HoraInicio" type="hidden" name="AulaPaa[0].HoraDeInicioDasAulas" value="'+n.DadosAula[t].HoraInicio+'" /><\/td><td style="text-align: center !important;" class="selHoraDeFimDasAulas">'+n.DadosAula[t].HoraFim+'<input id="HoraFim" type="hidden" name="AulaPaa[0].HoraDeFimDasAulas" value="'+n.DadosAula[t].HoraFim+'" /><\/td><td style="text-align: center !important;"><a class="selExcluirAula"><i class="icone-tabela-excluir" title="Excluir"><\/i><\/a><\/td><\/tr>');fct_AtualizaLinhasTabela();fct_AtualizaInputsTabela();fct_QuantidadeAulasPaa()}}function fct_AtualizaLinhasTabela(){var n=0;$("#tblHorasPAA tr").each(function(){$(this).find("td").eq(0).text(n);n++})}function fct_AtualizaInputsTabela(){function n(n,t){var i=0;$("input[id="+n+"]").each(function(){$(this).prop("name","AulaPaa["+i+"]."+t);i++})}n("Codigo","Codigo");n("InicioVigencia","DtInicioVigencia");n("FimVigencia","DtFimVigencia");n("DiaDaSemana","DiaDaSemana");n("HoraInicio","HoraDeInicioDasAulas");n("HoraFim","HoraDeFimDasAulas")}function fct_QuantidadeAulasPaa(){$("table#tblHorasPAA > tbody >tr").length>=_qtdeAulasPaa?($("#btnSalvarAulasPaa").prop("disabled",!1),$("#btnAdicionarAulaPaa").prop("disabled",!0)):($("#btnSalvarAulasPaa").prop("disabled",!0),$("#btnAdicionarAulaPaa").prop("disabled",!1))}function fct_CarregarTurnoPaa(n){var t=$("#FormListarEditarAtribuicaoAulA select#ddlTurnosPaa");t.empty();t.append(new Option("Selecione","",!0,!0));$.getJSON("/Turno/CarregarTurnoPorEscola",{CodigoEscola:n},function(n){$.each(n,function(n,i){t.append($("<option/>",{value:i.value,text:i.text}))})})}function abrirFormAtribuicaoAtpc(n,t,i,r,u,f){$.ajax({url:"/AtribuicaoAula/ViewAdicionarAtribuicaoAtpc",type:"POST",dataType:"html",data:{cdDiretoria:n,cdEscola:t,cpf:i,di:r,nome:u,flSituacao:f},success:function(e){$("#formAtribuicaoAtpc").html(e).dialog({modal:!0,draggable:!1,width:685,position:["center",0],close:function(){element==null?PesquisarDi(n,t,i,r,u,f):(visualizarAtribuicoes(element),flag=!0);$("#formAtribuicaoAtpc").html("");$("#formAtribuicaoAtpc").dialog("destroy")}});$("#DtInicioVigenciaInserir").datepicker("option","numberOfMonths",1).datepicker("setDate",null);$("#DtFimVigenciaInserir").datepicker("option","numberOfMonths",1).datepicker("setDate",null)}})}function adicionarAtribuicaoAtpc(n){if(n.Sucesso){var t=$("#txtNmProfessor").val(),i=$("#txtDi").val();triggerEditarAtribuicaoAtpc();triggerExcluirAtribuicaoAtpc()}}function triggerExcluirAtribuicaoAtpc(){$(".selExcluirAtribuicaoAtpc").unbind("click").click(function(n){if(n.stopPropagation(),confirm("Tem certeza que deseja excluir essa Atpc?")){var t=$(this).parents("tr");$.ajax({url:"/AtribuicaoAula/ExcluirAtribuicaoAtpc",type:"POST",data:{cdAtribuicao:t.attr("cdAtribuicao")},success:function(n){n.Sucesso&&t.remove()}})}})}function triggerEditarAtribuicaoAtpc(){$(".selEditarAtribuicaoAtpc").unbind("click").click(function(n){n.stopPropagation();var t=$(this).parents("tr");$.ajax({url:"/AtribuicaoAula/ViewEditarAtribuicaoAtpc",type:"POST",dataType:"html",data:{cdAtribuicao:t.attr("cdAtribuicao")},success:function(n){$("#formEditarAtribuicaoAtpc").html(n).show().dialog({modal:!0,draggable:!1,width:685,position:["center",0],close:function(){$("#formEditarAtribuicaoAtpc").html("");$("#formEditarAtribuicaoAtpc").dialog("destroy")}});AplicarMascaras();triggerEditarAulaAtpc();triggerExcluirAulaAtpc();$("#btnAdicionarAtribuicaoAtpc").click(function(){var n=$("#tbAtribuicoesAtpc").find("tbody").children().find("td").text();n!=""&&($("#btnFinalizarCadastro").show(),$("#tabelaDi").find(".selEdicaoAtpc").show());$("#formEditarAtribuicaoAtpc").html("");$("#formEditarAtribuicaoAtpc").dialog("destroy");$("#tbAtribuicoesAtpc").find("tr[cdAtribuicao="+t.attr("cdAtribuicao")+"]").addClass("adicionada")})}})})}function adicionarAulaAtpc(n){var r,u,t;if(n.Sucesso){r=$(".selCdAtribuicaoAtpc");r.val()=="0"&&$("#tbAtribuicoesAtpc tr[cdAtribuicao="+n.DadosAula[0].CodigoAtribuicao+"]").length==0&&adicionarAtribuicaoAtpc({Sucesso:!0,CdAtribuicao:n.DadosAula[0].CodigoAtribuicao});r.val(n.DadosAula[0].CodigoAtribuicao);var i=$("#formAulaAtpc"),f=$(".ddlDiaDaSemanaAtpc :selected").text(),e=i.find("#txtHoraDeInicioDasAulasAulaAtpc").val(),o=i.find("#txtHoraDeFimDasAulasAulaAtpc").val(),s=$("#DtInicioVigenciaInserir").val(),h=$("#DtFimVigenciaInserir").val();for(n.DadosAula[0].NomeSemana==""&&(n.DadosAula[0].NomeSemana=i.find(".ddlDiaDaSemanaAtpc :selected").text()),u=$("#TabelaDeHorasAtpc"),u.find(".semResultado").hide(),t=0;t<n.DadosAula.length;t++)u.append('<tr cdAula="'+n.DadosAula[t].CodigoAula+'" cdAtrib="'+n.DadosAula[t].CodigoAtribuicao+'" ><td style="text-align: center !important; font-size: 14px;" class="selDataInicio">'+n.DadosAula[t].DataInicioVigencia+'<\/td><td style="text-align: center !important; font-size: 14px;" class="selDataFim">'+n.DadosAula[t].DataFimVigencia+'<\/td><td style="text-align: center !important; font-size: 14px;" class="selDiaDaSemanaAtpc">'+n.DadosAula[t].NomeSemana+'<\/td><td style="text-align: center !important; font-size: 14px;" class="selHoraDeInicioDasAulasAtpc">'+n.DadosAula[t].HoraInicio+'<\/td><td style="text-align: center !important; font-size: 14px;" class="selHoraDeFimDasAulasAtpc">'+n.DadosAula[t].HoraFim+'<\/td><td style="text-align: center"><a class="selEditarAulaAtpc"><i class="icone-tabela-editar" title="Editar"><\/i><\/a><\/td><td style="text-align: center"><a class="selExcluirAulaAtpc"><i class="icone-tabela-excluir" title="Excluir"><\/i><\/a><\/td><\/tr>');triggerEditarAulaAtpc();triggerExcluirAulaAtpc();i.html("");i.dialog("destroy")}}function triggerEditarAulaAtpc(){$(".selEditarAulaAtpc").unbind("click").click(function(n){n.stopPropagation();var t=$(this).parents("tr").eq(0);$.ajax({url:"/AtribuicaoAula/ViewEditarAulaAtpc",type:"POST",dataType:"html",data:{cdAula:t.attr("cdAula")},success:function(n){$("#formEditarAulaAtpc").html(n).dialog({modal:!0,draggable:!1,width:600,position:["center",0],close:function(){$("#formEditarAulaAtpc").html("");$("#formEditarAulaAtpc").dialog("destroy")}});AplicarMascaras();InserirAlterarAulaAtpc()}})})}function editarAulaAtpc(n){if(n.Sucesso){var i=$("#formEditarAulaAtpc"),t=$("tr[cdAula="+n.DadosAula[0].CodigoAula+"]");t.find(".selDiaDaSemanaAtpc").text(n.DadosAula[0].NomeSemana);t.find(".selDataInicio").text(n.DadosAula[0].DataInicioVigencia);t.find(".selDataFim").text(n.DadosAula[0].DataFimVigencia);t.find(".selHoraDeInicioDasAulasAtpc").text(n.DadosAula[0].HoraInicio);t.find(".selHoraDeFimDasAulasAtpc").text(n.DadosAula[0].HoraFim);i.html("");i.dialog("destroy")}}function abrirFormAulaAtpc(n,t,i,r){var u=$(".selCdAtribuicaoAtpc").val();$.ajax({url:"/AtribuicaoAula/ViewAdicionarAulaAtpc",type:"POST",data:{cdAtribuicao:u,cdDiretoria:n,cdEscola:t,cpf:i,di:r,dtInicioVig:$("#_DtInicioVigenciaInserir").val(),dtFimVig:$("#_DtFimVigenciaInserir").val()},success:function(n){(typeof n!="object"||n.PodeAdicionar)&&($("#formAulaAtpc").html(n).dialog({modal:!0,draggable:!1,width:600,position:["center",0],close:function(){$("#formAulaAtpc").html("");$("#formAulaAtpc").dialog("destroy")}}),validacoes(),AplicarMascaras())}})}function triggerExcluirAulaAtpc(){$(".selExcluirAulaAtpc").unbind("click").click(function(n){if(n.stopPropagation(),confirm("Tem certeza que deseja excluir esse Horário de Atpc?")){var t=$(this).parents("tr").eq(0);$.ajax({url:"/AtribuicaoAula/ExcluirAulaAtpc",type:"POST",data:{cdAula:t.attr("cdAula")},success:function(n){var u,i,r;n.Sucesso&&(t.remove(),n.CdAtribuicao>0&&(u=$("tr[cdAtribuicao="+n.CdAtribuicao+"]"),u.remove(),i=$("#formAtribuicaoAtpc"),i.attr("class")=="ui-dialog-content ui-widget-content"&&(i.html(""),i.dialog("destroy")),r=$("#formEditarAtribuicaoAtpc"),r.attr("class")=="ui-dialog-content ui-widget-content"&&(r.html(""),r.dialog("destroy"))))}})}})}function InserirAlterarAulaAtpc(){$("#btnAdicionarEditarAulaAtpc").click(function(n){if(n.preventDefault(),ValidarCamposAdicionarAulaAtpc()){var t="";t=$("#btnAdicionarEditarAulaAtpc").val()=="Adicionar"?"/AtribuicaoAula/AdicionarAulaAtpc":"/AtribuicaoAula/EditarAulaAtpc";$.ajax({cache:!1,url:t,type:"POST",dataType:"JSON",data:$("#formAdicionarEditarAulaAtpc").serialize(),success:function(n){n.Sucesso&&($("#btnAdicionarEditarAulaAtpc").val()=="Adicionar"?adicionarAulaAtpc(n):editarAulaAtpc(n))},error:function(){$.ajaxStop()}})}else return!1});ValidarInserirAulaAtpc()}function ValidarInserirAulaAtpc(){$("#formAdicionarEditarAula").validate({rules:{"ListaAula[0].DiaDaSemana":"required","ListaAula[0].DtInicioVigencia":"required","ListaAula[0].DtFimVigencia":"required","ListaAula[0].HoraDeInicioDasAulas":"required","ListaAula[0].HoraDeFimDasAulas":"required"},messages:{"ListaAula[0].DiaDaSemana":"Obrigatório","ListaAula[0].DtInicioVigencia":"Obrigatório","ListaAula[0].DtFimVigencia":"Obrigatório","ListaAula[0].HoraDeInicioDasAulas":"Obrigatório","ListaAula[0].HoraDeFimDasAulas":"Obrigatório"}})}function ValidarCamposAdicionarAulaAtpc(){var u=$("#ddlDiaDaSemanaAulaAtpc").size(),n=parseInt($("#txtHoraDeInicioDasAulasAulaAtpc").val().split(":")[0]),t=parseInt($("#txtHoraDeInicioDasAulasAulaAtpc").val().split(":")[1]),i=parseInt($("#txtHoraDeFimDasAulasAulaAtpc").val().split(":")[0]),r=parseInt($("#txtHoraDeFimDasAulasAulaAtpc").val().split(":")[1]),f=n>=00&&n<=23&&t>=00&&t<=59&&i>=00&&i<=23&&r>=00&&r<=59;return u==0?(alert("Campo Dias da Semana é obrigatório."),!1):f?$("#txtHoraDeInicioDasAulasAulaAtpc").val()==$("#txtHoraDeFimDasAulasAulaAtpc").val()?(alert("A hora início não pode ser igual a hora final"),!1):$("#DtInicioVigenciaInserir").val()==""?(alert("Campo Início de Vigência é obrigatório."),!1):$("#DtFimVigenciaInserir").val()==""?(alert("Campo Início de Vigência é obrigatório."),!1):!0:(alert("Hora inválida"),!1)}var _cpf,_qtdeAulasPaa=19,element,flag,dataExterno,adicionarAula,t,InserirAlterarAula;$(document).ready(function(){$("#ddlDiretoriaPesquisar").autoPreencher($("#ddlEscolaPesquisar"),"Escola","CarregarListaEscolas");$("#btnPesquisar").click(function(){var n=$("#formIndex");n.valid()&&n.submit()});$("#btnCadastrarAtribuicao").click(function(){$.ajax({url:"/AtribuicaoAula/Inserir",type:"GET",dataType:"html",success:function(n){$("#modalInserir")[0].innerHTML=n;$("#modalInserir").dialog({modal:!0,width:810,position:["center",0],close:function(){$("#modalInserir").html("");$("#modalInserir").dialog("destroy")}});validacoes();FuncoesTile();AplicarMascaras();validacoes();$("#ddlDiretoriaCadastro").autoPreencher($("#ddlEscolaCadastro"),"Escola","CarregarListaEscolas");$("#ddlEscolaCadastro").change(function(){$(this).val()!=0&&$("div#cpf").fadeIn("slow")});$("#btnPesquisarCpf").click(function(){var n=$("#ddlDiretoriaCadastro").val(),t=$("#ddlEscolaCadastro").val(),i=$("#txtCpfCadastro").val();visualizarDis(n,t,i)})}})});$("#formIndex").validate({rules:{CdDiretoria:"required",CdEscola:"required",DataFrequencia_Anual:"required"},messages:{CdDiretoria:"Obrigatório",CdEscola:"Obrigatório",DataFrequencia_Anual:"Obrigatório"}});$("#tblHorasPAA tbody tr td i").live("click",function(){$(this).parent().parent().parent().remove();$("#tblHorasPAA tbody tr").length==0?$("#tblHorasPAA tbody").append('<tr class="semResultado"><td colspan="7">Não há horários de PAA cadastrados<\/td><\/tr>'):fct_AtualizaLinhasTabela();fct_AtualizaInputsTabela();fct_QuantidadeAulasPaa()})});element=null;flag=!1;adicionarAula=function(n){var r,u,e,i,f,t;if(dataExterno=n,console.log("data.length: "+n.length),console.log("data[0]: "+n[0]),data2=n,n.length>0&&(data2=n[0]),console.log("data2: "+data2),data2.Sucesso){for(r=ObterFormAtribuicao(),u=r.find(".selCdAtribuicao"),u.val()=="0"&&$("#tbAtribuicoes tr[cdAtribuicao="+data2.DadosAula[0].CodigoAtribuicao+"]").length==0&&adicionarAtribuicao({Sucesso:!0,CdAtribuicao:data2.DadosAula[0].CodigoAtribuicao}),u.val(data2.DadosAula[0].CodigoAtribuicao),r.find("#ddlTpAtrib, #ddlTipoEnsinoCadastro, #ddlTurmaCadastro, #ddlDisciplinaCadastro, #DtInicioVigenciaInserir, #DtFimVigenciaInserir").prop("disabled",!0),$("#nrAulas").length>0&&(e=parseInt($.trim($("#nrAulas").text())),$("#nrAulas").text(e+data2.DadosAula.length)),data2.DadosAula[0].NomeSemana==""&&(data2.DadosAula[0].NomeSemana=i.find(".ddlDiaDaSemana :selected").text()),i=$("#formAula"),f=$("table.tbAulas"),f.find(".semResultado").hide(),t=0;t<n.length;t++)f.append('<tr cdAula="'+n[t].DadosAula[0].CodigoAula+'" cdAtrib="'+n[t].DadosAula[0].CodigoAtribuicao+'" ><td style="text-align: center !important; font-size: 14px;" class="selDataInicio">'+n[t].DadosAula[0].DataInicioVigencia+'<\/td><td style="text-align: center !important; font-size: 14px;" class="selDataFim">'+n[t].DadosAula[0].DataFimVigencia+'<\/td><td style="text-align: center !important; font-size: 14px;" class="selDiaDaSemana">'+n[t].DadosAula[0].NomeSemana+'<\/td><td style="text-align: center !important; font-size: 14px;" class="selHoraDeInicioDasAulas">'+n[t].DadosAula[0].HoraInicio+'<\/td><td style="text-align: center !important; font-size: 14px;" class="selHoraDeFimDasAulas">'+n[t].DadosAula[0].HoraFim+'<\/td><td style="text-align: center"><a class="selEditarAula"><i class="icone-tabela-editar" title="Editar"><\/i><\/a><\/td><td style="text-align: center"><a class="selExcluirAula"><i class="icone-tabela-excluir" title="Excluir"><\/i><\/a><\/td><\/tr>');triggerEditarAula();triggerExcluirAula();i.html("");i.dialog("destroy")}};InserirAlterarAula=function(){$("#btnAdicionarEditarAula").click(function(n){if(n.preventDefault(),ValidarCamposAdicionarAula()){var t="";t=$("#btnAdicionarEditarAula").val()=="Adicionar"?"/AtribuicaoAula/AdicionarAula":"/AtribuicaoAula/EditarAula";$.ajax({cache:!1,url:t,type:"POST",dataType:"JSON",data:$("#formAdicionarEditarAula").serialize(),success:function(n){console.log("data.length: "+n.length);var t=n;n.length>0&&(t=n[0]);console.log("data2: "+t);console.log("data2.Sucesso: "+t.Sucesso);t.Sucesso&&($("#btnAdicionarEditarAula").val()=="Adicionar"?adicionarAula(n):(console.log("sucesso editar"),editarAula(n)))},error:function(){$.ajaxStop()}})}else return!1});ValidarInserirAula()};
/*
//# sourceMappingURL=AtribuicaoAula.min.js.map
*/