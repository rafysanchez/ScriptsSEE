function preveMencaoFechamento(){for(var r=$(".tableTurma").children("tbody").children("tr"),t=$("#txtMencoes").val().split("|"),u,f,i,n=0;n<t.length-1;n++)u=[],u=t[n].split("-"),t[n]=u;for(n=0;n<r.length;n++)if($("select option[selected=selected]",r).val()==0)for(f=$(".tbMediaPrevista",r[n]).html(),i=0;i<t.length-1;i++)f>t[i][1]&&(t.length-1>i?$(".ddlMencao",r[n]).val(t[i+1][0]):$(".ddlMencao",r[n]).val(t[i][0]))}function salvarFechamentos(){var i="",r="",u="",f="",e="",o="",t=!0,s=0,n=0;$(".tableTurma").children("tbody").children("tr").each(function(){i+=$(this).find(".tdCodigoFechamento").data("codigo-fechamento")+"|";r+=$(this).find(".tdCodigoMatricula").html()+"|";u+=$(this).find(".ddlMencao").val()+"|";f+=$(this).find("#txtNumeroFaltas").val()+"|";e+=$(this).find("#fechamento_FaltasCompensadas").val()+"|";o+=$(this).find("#fechamento_Justificativa").val().replace("|","")+"|";s=$(this).find("#txtNumeroFaltas").val();n=$(this).find("#fechamento_FaltasCompensadas").val();isNaN(n)||n==""?($(this).find("#fechamento_FaltasCompensadas").css("border-color","red"),t=!1):(parseInt(n)>parseInt(s)||parseInt(n)<0)&&($(this).find("#fechamento_FaltasCompensadas").css("border-color","red"),t=!1)});t?$.ajax({type:"POST",async:!0,dataType:"json",data:{CodigosFechamento:i,CodigosMatriculaAluno:r,Mencoes:u,NumerosFaltas:f,NumerosFaltasCompensadas:e,Justificativas:o,CodigoDisciplina:$("#txtCodigoDisciplina").val(),CodigoEventoCalendario:$("#txtCodigoEventoCalendario").val(),CodigoTipoFechamento:$("#ddlTipoFechamento").val(),CodigoBanca:$("#CodigoBanca").val(),CodigoTurma:parseInt($("#txtCodigoTurma").val()),CodigoEscola:parseInt($("#txtCodigoEscola").val()),anoLetivo:$("#txtAnoLetivo").val()},url:"/Fechamento/GravarFechamentos",success:function(){CarregarFechamentos()},error:function(){}}):Mensagem.Alert({titulo:"Fechamento",mensagem:"O valor das Faltas Compensadas deve ser numérico, positivo e menor ou igual o número de faltas do aluno.",tipo:"Erro",botao:"Fechar"})}function bindAtividades(){$(document).ready(function(){$(".btAtividades").each(function(){$(this).click(function(){AbrirAtividades($(this).parent().parent().find(".Atividades"))})})})}function AbrirAtividades(n){$("#atividadesDialog").html(n.clone().show()).dialog({width:600,draggable:!0,modal:!0,resizable:!1,position:"center"})}function CarregarComboEscola(){}function CarregarLista(){var t=$("#txtAnoLetivo").val(),n=$("#ddlEscola").val();n.length>0&&n>0&&$.ajax({type:"POST",async:!0,dataType:"html",data:{codigoEscola:parseInt(n),anoLetivo:parseInt(t)},url:"/Fechamento/ListaParcial",success:function(n){$("#divListaParcial").empty().html(n);$("#imgAtualizar").css("visibility","visible");$("#table").sedDataTable()},error:function(){}})}function AbrirFechamento(n){var t=parseInt($(n).data("existeavaliacao")),i=parseInt($(n).data("existefrequencia")),r=parseInt($(n).data("codigosubturma")),u=parseInt($("#txtAnoLetivo").val());$.ajax({type:"POST",async:!0,dataType:"html",data:{cpfProfessor:$(n).data("cpfprofessor"),nomeProfessor:$(n).data("nomeprofessor"),codigoTipoEnsino:parseInt($(n).data("codigotipoensino")),tipoEnsino:$(n).data("tipoensino"),codigoTurma:parseInt($(n).data("codigoturma")),turma:$(n).data("turma"),codigoSubTurma:r,subturma:$(n).data("nomesubturma"),periodo:$(n).data("periodo"),codigoDisciplina:parseInt($(n).data("codigodisciplina")),disciplina:$(n).data("disciplina"),codigoEscola:parseInt($(n).data("codigoescola")),nomeEscola:$(n).data("nomeescola"),codigoDiretoria:parseInt($(n).data("codigodiretoria")),anoLetivo:u},url:"/Fechamento/SelecionaTipoFechamento",success:function(n){$("#dialog").html(n).dialog({width:900,draggable:!0,modal:!0,resizable:!1,position:"top"});$("#txtExisteAvaliacao").val(t);$("#txtExisteFrequencia").val(i)},error:function(){}})}function CarregarFechamentos(){$("#ddlTipoFechamento").val().length>0&&$.ajax({type:"POST",async:!0,dataType:"html",data:{cpfProfessor:$("#txtCpfProfessor").val(),nomeProfessor:$("#txtNomeProfessor").val(),codigoTipoEnsino:parseInt($("#txtCodigoTipoEnsino").val()),tipoEnsino:$("#txtTipoEnsino").val(),codigoTurma:parseInt($("#txtCodigoTurma").val()),turma:$("#txtTurma").val(),codigoSubTurma:parseInt($("#txtCodigoSubTurma").val()),subturma:$("#txtSubTurma").val(),periodo:$("#txtPeriodo").val(),codigoDisciplina:parseInt($("#txtCodigoDisciplina").val()),disciplina:$("#txtDisciplina").val(),codigoEscola:parseInt($("#txtCodigoEscola").val()),nomeEscola:$("#txtNomeEscola").val(),codTipoFechamento:$("#ddlTipoFechamento").val(),codigoDiretoria:$("#txtCodigoDiretoria").val(),tipoFechamento:$("#ddlTipoFechamento option:selected").text()},url:"/Fechamento/Fechamento",success:function(n){$("#Fechamentos").html(n);$("#fechamentoTabs").tabs({beforeActivate:function(n,t){var i=t.newPanel.attr("id"),r;$("#"+i).find(".tableTurma").dataTable().fnDestroy();DataTable($("#"+i).find(".tableTurma"));r=$("#"+i).find(".tableTurma").dataTable();r.length>0&&r.fnAdjustColumnSizing()}});DataTable($(".tableTurma"));bindAtividades();$("#Fechamentos div.aviso").length==0&&preveMencaoFechamento();var t=parseInt($("#txtExisteAvaliacao").val()),i=parseInt($("#txtExisteFrequencia").val());t!=1&&$(".ddlMencao").prop("disabled","disabled");i!=1?($("input#fechamento_FaltasCompensadas").each(function(){$(this).prop("disabled","disabled")}),$("input#fechamento_Justificativa").each(function(){$(this).prop("disabled","disabled")})):($("input#fechamento_FaltasCompensadas").each(function(){$(this).prop("disabled","")}),$("input#fechamento_Justificativa").each(function(){$(this).prop("disabled","")}))},error:function(){}})}function VisualizarMembrosBanca(){$.ajax({type:"POST",dataType:"html",data:{CodigoBanca:$("#CodigoBanca").val()},url:"/Fechamento/Banca",success:function(n){$("#atividadesDialog").html(n).dialog({width:400,draggable:!0,modal:!0,resizable:!1,position:"center",title:"Membros do Conselho"})},error:function(){}})}function DataTableImprimir(n){$(n).dataTable({bPaginate:!1,bSort:!0,bJQueryUI:!0,bFilter:!0,bInfoEmpty:!0,bInfo:!0,iDisplayLength:-1,iCookieDuration:60,bStateSave:!1,bAutoWidth:!1,bScrollAutoCss:!0,bProcessing:!0,bRetrieve:!0,bDestroy:!0,sDom:'<"H"T<"cl">lfr>t<"F"ip>',oTableTools:{aButtons:[{sExtends:"print",sButtonText:"Imprimir",aButtons:["print"],sInfo:"<h6>Visualização de Impressão<\/h6><p>Para imprimir, utilize a opção de impressão do navegador. Pressione ESC para terminar.<\/p>"}]},aLengthMenu:[[25,50,100,-1],[25,50,100,"All"]],sScrollXInner:"110%",aaSorting:[[1,"asc"]],fnInitComplete:function(){this.css("visibility","visible")},oLanguage:{sProcessing:"Processando...",sZeroRecords:"Não foram encontrados resultados",sSearch:"Buscar:"}})}function DataTable(n){$(n).dataTable({bPaginate:!1,bSort:!0,bJQueryUI:!0,bFilter:!0,bInfoEmpty:!0,bInfo:!0,iDisplayLength:-1,iCookieDuration:60,bRetrieve:!0,bDestroy:!0,aLengthMenu:[[25,50,100,-1],[25,50,100,"All"]],sScrollXInner:"110%",aaSorting:[[1,"asc"]],fnInitComplete:function(){this.css("visibility","visible")},oLanguage:{sProcessing:"Processando...",sZeroRecords:"Não foram encontrados resultados",sSearch:"Buscar:"}})}$(document).ready(function(){$("#ddlDiretoria").autoPreencher($("#ddlEscola"),"Escola","CarregarListaEscolas")});var tbTurma;
/*
//# sourceMappingURL=Fechamento.min.js.map
*/